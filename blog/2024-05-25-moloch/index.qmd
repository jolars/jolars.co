---
title: "Moloch: A Revival of the Metropolis LaTeX Beamer Theme"
author: Johan Larsson
date: "2024-05-15"
draft: true
description: |
  Metropolis is a popular and modern beamer theme for LaTeX, but it is
  unfortunately no longer actively maintained and contains several bugs. 
  Moloch is a fork of Metropolis that aims to fix these issues and add
  a few new features.
categories:
  - latex
  - software
  - presentations
  - beamer
image: moloch-logo.svg
fig-cap-location: margin
---

My beamer configuration for LaTeX presentations has been in a state of flux for as long as I can remember. 
I have tried many different themes and configurations, and have typically tried to keep the theme minimalisic
but at the same time functional and visually appealing. Nevertheless, I have frequently found
myself scrapping my custom modifications and returning to the [Metropolis theme](https://github.com/matze/mtheme),
which I think is the most well-designed theme that I have so far encountered for beamer.

The only problem is that Metropolis is no longer actively maintained. The latest update (at the time of writing)
was six years ago and since then a number of issues have cropped up. Most of them are not major and can
be circumvented through various hacks and workarounds, but I have grown increasingly frustrated with the
separate file of Metropolis patches that I've had to keep around to fix these issues.
Beamer tself in fact even includes several patches now in order to stop the theme from breaking (see 
[here](https://github.com/josephwright/beamer/blob/c0d91f15165421646b5383546e6195187b7f97c9/base/beamerbasecompatibility.sty#L253),
[here](https://github.com/josephwright/beamer/blob/c0d91f15165421646b5383546e6195187b7f97c9/base/beamerbasesection.sty#L209), and 
[here](https://github.com/josephwright/beamer/blob/c0d91f15165421646b5383546e6195187b7f97c9/base/beamerbaselocalstructure.sty#L29).)

## Moloch

This has now (since some months back actually) led me to fork Metropolis to try to fix these outstanding issues.
I call the new theme *Moloch* (which is likely familiar to you if you know your Metropolis).
The original design is still pretty much intact save for a few minor tweaks, such as changing the green
color from Metropolis to a teal color that is a little more color-blind friendly. The largest differences,
except for pure bug fixes, is that the code for the theme has been simplified and made more robust.
Metropolis, for instance, made much use of `\patchcmd` from the etoolbox package to patch beamer 
theme internals in order to support modifications to, for instance, frame titles. This was what
lead the theme to break in the first place as beamer introduced changes in these commands and I 
have thus opted to remove all this kind of patching in favor of relying on standard functionality
from the beamer theme instead.

This comes at the price of sacrificing some features, such as toggling title formatting between uppercase,
small caps, and regular text. But, as the Metropolis documentation itself noted, these
modifications were problematic in the first place and I therefore think that the removal of these
features is on the whole a good thing.

I've also removed the pgfplots theme that was included in Metropolis. I don't mind the theme per se,
but I believe it was only of limited use and 

## Changes

I've tried to outline the main changes that I can think of in the following sections.

### New Secondary Color

I always though the green color in Metropolis was lurid and not exactly color-blind friendly.
I therefore changed it to a teal color that I think is a little more subdued and easier on the eyes.

You can see the difference in the figure below. I hope you agree that the
new color is an improvement!

![The old versus the new secondary color.](new-secondary-color.svg){width=100% .border}

One of the future plans for Moloch is to make these colors more easily customizable.

### Subtitles

Subtitles are now supported in Moloch. They were were not supported in Metropolis
because the author [thought subtitles were a bad idea i general](https://github.com/matze/mtheme/issues/135).
On the whole I agree that subtitles are usually best avoided, but I didn't see any reason
to impose this opinion on others. Subtitles are therefore supported in Moloch.

![Subtitles are supported in Moloch.](subtitles.png)

### Frame Numbering

Metropolis sported its own frame numbering system. There was nothing wrong with this 
system except it necessitated a separate package (appendixframenumber) to get frame/page numbers 
to restart (and not count towards the total number) for appendix slides.
Beamer has, however, improved its own system in recent years and there is no longer
any need for a custom solution (or separate package) to support this functionality.
As a result, Moloch just relies on beamer templates for the frame numbering.
The design is *slightly* different, with smaller font size and somewhat different margins,
but I only think this is for the better anyway.

Now, you can just change it via the standard beamer commands for frame numbering, like so:

```latex
\setbeamertemplate{page number in head/foot}[appendixframenumber]
```

### Title Page Redesign

The title page has been redesigned. The primary changes are

1. The institute is now positioned below the author (rather than the date), which I think makes more sense.
   This was suggested in [an issue on the Metropolis repo](https://github.com/matze/mtheme/issues/180).
2. The titlegraphic now has margins added above and below. It was previously put in a zero-height
   `vbox`, but this caused inconsistent bottom-top margins for the content on the title page.
   You can still achieve the behavior just be wrapping the title graphic in the same kind of
   `vbox`, however, so I see this as a less imposing default.
3. The margins around the elements on the title page were changed everywhere. Please see the screenshots
   below to see what I mean, but the main change is that there is less spacing between the title and the
   subtitle and even spacing above and below the orange line.

![The old title page from Metropolis](metropolis-titlepage.svg){width=100% .border}

![The new title page in Moloch](moloch-titlepage.svg){width=100% .border}

For reference, the code for generating the slides is given below.

<details>
<summary>Code</summary>

```latex
\documentclass[10pt]{beamer}

\usetheme{moloch}

\title{Title}
\subtitle{Subtitle}
\author{Author}
\institute{Institute}
\date{\today}
\titlegraphic{\hfill\includegraphics[height=2cm]{logo.pdf}}

\begin{document}
\maketitle
\end{document}
```

</details>

I am open for suggestions and discussions on how to further improve the title page layout, or 
make customizing it easier.


### Font Settings

### Other Miscellaneous Changes

- [Progress bars work better for wide presentation](https://github.com/matze/mtheme/pull/384)
- [Removed custom appendix section modifications](https://github.com/matze/mtheme/pull/342)

